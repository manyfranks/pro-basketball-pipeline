# NBA SGP Engine - Railway Configuration
# Docs: https://docs.railway.app/reference/config-as-code

[build]
builder = "dockerfile"
dockerfilePath = "Dockerfile"

[deploy]
numReplicas = 1
restartPolicyType = "on_failure"
restartPolicyMaxRetries = 3

# =============================================================================
# CRON SCHEDULE - HOURLY SCHEDULER
# =============================================================================
# The scheduler runs hourly and checks if any jobs should run at the current hour.
# This allows multiple run times from a single Railway service.
#
# Scheduled Jobs (all times UTC):
#   - Morning (15:00 UTC = 10am ET): Settlement + SGP generation
#   - Afternoon (19:00 UTC = 2pm ET): Final SGP after injury cutoff
#
# The scheduler handles time checks internally - only runs jobs at their scheduled hours.
cronSchedule = "0 * * * *"
startCommand = "python -m scheduler.nba_scheduler"

# =============================================================================
# CRON BEHAVIOR
# =============================================================================
# Hourly cron triggers the scheduler, which checks current time and runs:
#   - 15:00 UTC: Morning run (settlement + SGP generation)
#   - 19:00 UTC: Afternoon run (SGP refresh after injury reports)
# At all other hours, scheduler exits without running any jobs.

# =============================================================================
# ENVIRONMENT VARIABLES (set in Railway dashboard)
# =============================================================================
# Required:
#   SUPABASE_URL=https://xxx.supabase.co
#   SUPABASE_KEY=eyJhbG...
#   ODDS_API_KEY=xxx
#
# Optional:
#   OPENROUTER_API_KEY=xxx (for LLM thesis generation)
